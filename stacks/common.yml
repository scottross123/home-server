x-deploy: &deploy
  placement:
    constraints:
      - node.role == manager
  restart_policy:
    condition: on-failure
    delay: 0s
    max_attempts: 5
    window: 120s
  rollback_config:
    order: stop-first
    failure_action: rollback
    delay: 10s
    parallelism: 0
    monitor: 30s
    max_failure_ratio: 3
  update_config:
    order: stop-first
    failure_action: rollback
    delay: 0s
